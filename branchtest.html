<html>
  <head>
    <title>Branch Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="/camera/build.js"></script>
    
  </head>

  <body>
    Send SMS
        <form onsubmit="sendSMS(this); return false;">
            <input id="phone" name="phone" type="tel" placeholder="(995) 577 712021" />
            <br/>
            <input type="submit"/>
        </form>
        <a href="#" id="link">Link</a>
  </body>
  <script type="text/javascript">

    (function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent disableTracking getBrowserFingerprintId crossPlatformIds lastAttributedTouchData".split(" "), 0);
    var refLinkData ;
    branch.init('key_live_jjwPR3AIEyQE06TroDfY0gcnCEpce7Zh', function(err, data) {
      refLinkData = data;
      //console.log(refLinkData);
    });

    
        function sendSMS(form) {
            window.parent.postMessage({message:"send",number:form.phone.value},"*");
            var phone = form.phone.value;
            var linkData = {
               
                channel: refLinkData.data_parsed['~channel'],
                feature: refLinkData.data_parsed['~feature'],
                
            };
            var options = {};
            var callback = function(err, result) {
                if (err) {
                    alert("Sorry, something went wrong.");
                }
                else {
                    alert("SMS sent!");
                }
            };
            branch.sendSMS(phone, linkData, options, callback);
            form.phone.value = "";
        }
        $('#link').click(function() {
        
            
        branch.link({}, function(err, link) {
            var element = document.getElementById("link");
            element.href = link;
        });
    });
</script>
</html>
